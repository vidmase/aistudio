# Vocal & Instrument Stem Separation Guide

## Overview

The Stem Separation tool provides an interface for the KIE.ai Suno API vocal separation feature. 

**Important Note:** This API is designed to work with music generated by Suno's AI music generation service, not with uploaded audio files. You must first generate music using Suno API and then use the returned `taskId` to separate vocals.

## Intended Use Cases

- Separating vocals from Suno-generated music
- Creating instrumental versions of AI-generated songs
- Isolating individual instruments from Suno compositions
- Music production with Suno-generated tracks

## Features

### Two Separation Modes

1. **Vocal Split** (`separate_vocal`)
   - Separates audio into 2 stems:
     - Vocals
     - Instrumental

2. **Multi-Stem** (`split_stem`)
   - Separates audio into up to 12 stems:
     - Vocals
     - Backing Vocals
     - Drums
     - Bass
     - Guitar
     - Keyboard
     - Strings
     - Brass
     - Woodwinds
     - Percussion
     - Synth
     - FX/Other

## How to Use (Requires Suno Music Generation)

### Prerequisites
1. Generate music using Suno's music generation API
2. Obtain the `taskId` from the generation response
3. Optionally get the `audioId` if multiple variations exist

### Steps

1. **Navigate to the Stems Tab**
   - Click the "Stems" button in the left navigation menu

2. **Choose Separation Type**
   - Select "Vocal Split" for simple vocal/instrumental separation (2 stems)
   - Select "Multi-Stem" for detailed instrument separation (up to 12 stems)

3. **Provide Task Information**
   - You need the `taskId` from a Suno music generation task
   - Optionally provide `audioId` for specific variations

4. **Submit Separation Request**
   - The API will process the Suno-generated music
   - Wait for processing to complete (typically 30-60 seconds)

5. **Download Results**
   - Each stem will appear with its own audio player
   - Click "Download" on any stem to save it locally
   - All stems remain accessible for 14 days

## Alternative Solutions for Uploaded Audio

Since the Suno API only works with Suno-generated music, here are alternatives for separating vocals from your own audio files:

### Open Source Solutions
- **Spleeter** (by Deezer) - Python library, free
- **Demucs** (by Facebook Research) - State-of-the-art, free
- **Open-Unmix** - PyTorch-based, free

### Commercial Services
- **LALAL.AI** - Web-based, pay-per-use
- **Moises.ai** - App with free tier
- **AudioShake** - Professional-grade separation
- **RipX** - Desktop application

## API Integration

This feature uses the KIE.ai Suno API endpoints:

- **Submit Task**: `POST /api/v1/suno/separate-vocals`
- **Check Status**: `GET /api/v1/suno/get-vocal-separation-details`

### Required Environment Variables

Make sure your `.env.local` file contains:

```
KIE_API_KEY=your_kie_api_key_here
```

## Important Notes

- **Billing**: Each separation request is charged. Re-submitting the same track triggers a new credit deduction
- **Quality**: Separation quality depends on the complexity and mixing of the original track
- **Accessibility**: All generated audio URLs remain accessible for 14 days
- **Best Results**: Use clean, well-mixed audio tracks for optimal separation quality

## Troubleshooting

### "This feature requires a taskId from Suno music generation"
- This is expected - the API only works with Suno-generated music
- You must first use Suno's music generation API
- Use the returned `taskId` to separate vocals

### "Separation task failed"
- Verify your KIE_API_KEY is valid
- Check your account credits at https://kie.ai
- Ensure the taskId is from a completed Suno generation
- Verify the taskId hasn't expired (14 days)

### "Task timed out"
- The separation may still be processing
- Check your KIE.ai dashboard for task status
- The original music generation may have been too long

## Technical Details

### Supported Audio Formats
- MP3
- WAV
- FLAC
- AAC
- OGG
- M4A

### Processing Time
- Vocal Split: ~30-45 seconds
- Multi-Stem: ~45-90 seconds
- Time varies based on audio length and complexity

### Output Format
- All stems are returned as MP3 files
- Sample rate: 44.1kHz
- Bitrate: 320kbps

## API Reference

For detailed API documentation, visit:
- [Separate Vocals API](https://docs.kie.ai/suno-api/separate-vocals)
- [Get Separation Details](https://docs.kie.ai/suno-api/get-vocal-separation-details)
- [Callbacks](https://docs.kie.ai/suno-api/separate-vocals-callbacks)
